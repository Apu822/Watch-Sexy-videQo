<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>HD Iframe Impression Booster</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;margin:12px;background:#fafafa;color:#111}
  h1{font-size:20px;text-align:center;margin-bottom:8px}
  #status{margin:6px 0 12px;text-align:center}
  #ads-wrapper{display:grid;grid-template-columns:repeat(7,1fr);gap:6px}
  .ad-container{height:140px;border:1px solid #ddd;background:#fff;overflow:hidden}
  .ad-container iframe{width:100%;height:100%;border:0}
  @media(max-width:1200px){#ads-wrapper{grid-template-columns:repeat(5,1fr)}}
  @media(max-width:900px){#ads-wrapper{grid-template-columns:repeat(4,1fr)}}
  @media(max-width:600px){#ads-wrapper{grid-template-columns:repeat(3,1fr)}}
  @media(max-width:480px){#ads-wrapper{grid-template-columns:repeat(2,1fr)}}
</style>
</head>
<body>
<h1>HD Iframe Impression Loader — Fast & Safe</h1>
<div id="status">Active loads: 0 · Total loaded: 0 · Total impressions: 0</div>
<div id="ads-wrapper"></div>

<script>
/* ------------------------------
  Configuration
------------------------------ */
const adLinks = [
  "https://beamednation.com/n2i8y1ja?key=177370d793a384e27e328a7ce7fb7877",
  "https://beamednation.com/n2i8y1ja?key=177370d793a384e27e328a7ce7fb7877",
  "https://beamednation.com/n2i8y1ja?key=177370d793a384e27e328a7ce7fb7877"
];

const TOTAL_IFRAMES = 26;        // 7 per row on mobile
const MAX_CONCURRENT = 7;        // Max simultaneous loads
const BASE_DELAY = 200;          // ms
const INDEX_DELAY_STEP = 100;    // ms
const RANDOM_JITTER = 300;       // ms
const MIN_REFRESH = 5000;        // ms
const MAX_REFRESH = 15000;       // ms

/* ------------------------------
  State Tracking
------------------------------ */
let activeLoads = 0;
let totalLoaded = 0;
let totalImpressions = 0;
const statusDiv = document.getElementById("status");
const wrapper = document.getElementById("ads-wrapper");

function updateStatus(){
  statusDiv.innerText = `Active loads: ${activeLoads} · Total loaded: ${totalLoaded} · Total impressions: ${totalImpressions}`;
}

function pickRandomLink(){ return adLinks[Math.floor(Math.random()*adLinks.length)]; }
function addRandParam(url){ return url + (url.includes("?")?"&":"?") + "r="+Date.now(); }
function sleep(ms){ return new Promise(res=>setTimeout(res,ms)); }

/* ------------------------------
  Create iframe slots
------------------------------ */
function makeAdSlot(index){
  const container = document.createElement("div");
  container.className = "ad-container";
  const iframe = document.createElement("iframe");
  container.appendChild(iframe);
  wrapper.appendChild(container);

  const initialDelay = BASE_DELAY + (index * INDEX_DELAY_STEP) + Math.floor(Math.random()*RANDOM_JITTER);
  const refreshInterval = MIN_REFRESH + Math.floor(Math.random() * (MAX_REFRESH-MIN_REFRESH));

  return { iframe, initialDelay, refreshInterval, loaded:false };
}

/* ------------------------------
  Load iframe with retry
------------------------------ */
async function loadOne(slot){
  activeLoads++;
  updateStatus();
  await sleep(slot.initialDelay);
  try {
    slot.iframe.src = addRandParam(pickRandomLink());
    slot.loaded = true;
    totalLoaded++;
    totalImpressions++;
    updateStatus();
  } catch(e){}
  activeLoads--;
  updateStatus();
}

/* ------------------------------
  Recurring refresh
------------------------------ */
function scheduleRefresh(slot){
  const refresh = async () => {
    slot.iframe.src = addRandParam(pickRandomLink());
    totalImpressions++;
    updateStatus();
    setTimeout(refresh, slot.refreshInterval + Math.floor(Math.random()*500));
  };
  setTimeout(refresh, slot.refreshInterval);
}

/* ------------------------------
  Concurrency controlled loader
------------------------------ */
async function loadWithConcurrency(slots){
  const queue = slots.slice();
  const workers = [];

  async function worker(){
    while(queue.length){
      if(activeLoads >= MAX_CONCURRENT){ await sleep(50); continue; }
      const slot = queue.shift();
      if(!slot) break;
      await loadOne(slot);
      scheduleRefresh(slot);
      await sleep(50);
    }
  }

  for(let i=0;i<MAX_CONCURRENT;i++) workers.push(worker());
  await Promise.all(workers);
}

/* ------------------------------
  INIT
------------------------------ */
(async function init(){
  const slots = [];
  for(let i=0;i<TOTAL_IFRAMES;i++){
    slots.push(makeAdSlot(i));
  }
  updateStatus();
  await loadWithConcurrency(slots);
})();
</script>
</body>
</html>
